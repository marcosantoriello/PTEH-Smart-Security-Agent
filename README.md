# PTEH - Smart IDS & Firewall Agent

> **‚ö†Ô∏è EXPERIMENTAL PROJECT**
> This project is currently under development as part of the "Penetration Testing and Ethical Hacking" course at the University of Salerno.

## üéØ Project Goal

The primary objective of this project is to explore and study the **application of AI Agents (specifically Large Language Models)** in cybersecurity contexts. 

It is designed as an experimental framework to evaluate how effectively an LLM can:
1.  **Interpret** the complex output of an Anomaly-Based Intrusion Detection System (IDS).
2.  **Reason** about the detected threats.
3.  **Dynamically generate** valid and context-aware firewall rules to mitigate attacks in real-time.

Unlike traditional automated response systems based on static tables or scripts, this project investigates the "**reasoning**" capabilities of AI agents when faced with network anomalies.

## üèóÔ∏è Architecture Overview

The system is composed of several decoupled modules interacting through a Redis-based data pipeline:

1.  **Traffic Sniffer**: Captures network traffic in real-time and batches it into PCAP files.
2.  **Feature Extractor**: Processes PCAP files (using *NTLFlowLyzer*) to extract statistical features for machine learning analysis.
3.  **Anomaly-Based IDS**: A custom multiclass **Random Forest** classifier (trained on the CIC-IDS2017 dataset) that analyzes network flows to detect specific attacks (e.g., DoS, PortScan, Botnet).
4.  **AI Security Agent (LLM)**: *[Experimental]* The core of the study. An autonomous agent that monitors IDS alerts, analyzes the threat context (source IP, protocol, attack type, confidence), and formulates mitigation strategies.
5.  **Enforcement Module**: A dynamic firewall interface that validates and applies the rules generated by the AI Agent.

## üß† The AI Experiment

The key research question is: **Can an LLM act as an automated Security Analyst?**

The system feeds the AI Agent with structured JSON data from the IDS, containing:
-   Attack classification (e.g., "DoS Hulk")
-   Confidence scores
-   Flow metadata (IPs, Ports, Protocols)

The Agent is tasked with generating specific remediation commands (e.g., `iptables` rules) while minimizing false positives and ensuring syntax correctness. The project aims to measure the agent's ability to adapt to granular attack classifications provided by the IDS.
